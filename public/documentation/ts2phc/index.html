<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=content-security-policy content="default-src 'self'; connect-src 'self' https://linuxptp.nwtime.org https://www.clarity.ms https://j.clarity.ms https://www.google-analytics.com; child-src 'self'; font-src 'self' https://fonts.gstatic.com; form-action 'self'; frame-src 'self'; img-src 'self' 'unsafe-inline' 'unsafe-eval' https://linuxptp.nwtime.org https://www.google-analytics.com https://www.googletagmanager.com https://www.google.com https://clients1.google.com https://www.googleapis.com https://cse.google.com https://encrypted-tbn0.gstatic.com https://encrypted-tbn3.gstatic.com https://c.clarity.ms https://c.bing.com; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cse.google.com https://www.google.com; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.google-analytics.com https://www.googletagmanager.com https://cse.google.com https://www.google.com https://www.clarity.ms;"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel=canonical href=https://linuxptp.nwtime.org/documentation/ts2phc/><meta property="og:title" content="ts2phc(8): Synchronizes one or more PTP Hardware Clocks using external time stamps"><meta property="og:description" content="Man page for ts2phc which synchronizes PTP Hardware Clocks to external time stamp signals."><meta property="og:type" content="article"><meta property="og:url" content="https://linuxptp.nwtime.org/documentation/ts2phc/"><meta property="og:image" content="https://linuxptp.nwtime.org/images/featured.webp"><meta property="article:section" content="documentation"><meta property="article:published_time" content="2021-07-18T00:00:00+00:00"><meta property="article:modified_time" content="2021-07-18T00:00:00+00:00"><meta property="og:site_name" content="Linux PTP Project"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://linuxptp.nwtime.org/images/featured.webp"><meta name=twitter:title content="ts2phc(8): Synchronizes one or more PTP Hardware Clocks using external time stamps"><meta name=twitter:description content="Man page for ts2phc which synchronizes PTP Hardware Clocks to external time stamp signals."><script>window.onload=demo;function demo(){document.getElementById("gsc-i-id1").setAttribute("placeholder","Search...")}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-3L2S4S3B0T"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-3L2S4S3B0T',{anonymize_ip:!0})</script><script type=text/javascript>(function(a,e,b,f,g,c,d){a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},c=e.createElement(f),c.async=1,c.src="https://www.clarity.ms/tag/"+g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d)})(window,document,"clarity","script","coqaee2wun")</script><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com/ crossorigin><link href="https://fonts.googleapis.com/css?family=Nunito+Sans:400,400i,700,800,800i,900i&display=swap" rel=stylesheet><title>ts2phc(8): Synchronizes one or more PTP Hardware Clocks using external time stamps</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Man page for ts2phc which synchronizes PTP Hardware Clocks to external time stamp signals."><meta name=generator content="Hugo 0.83.1"><link rel=stylesheet href=/scss/nwtime.min.a5efbbfbaa08b24019d7dc707039f57c.css media=screen></head><body><nav class="navbar navbar-expand-lg navbar-light"><div class=container-fluid><div><a class=navbar-brand href=https://www.nwtime.org><img height=80 width=80 src=https://linuxptp.nwtime.org/images/logo.png alt></a>
<a class=navbar-brand style=color:#1a79c0!important;font-size:18px;font-weight:700;margin-left:20px href=https://linuxptp.nwtime.org/>LinuxPTP Project</a></div><div><button class="btn btn-light btn-lg" type=button aria-expanded=false><a class=nav-item style=text-decoration:none;text-transform:uppercase href=https://linuxptp.nwtime.org/about/>About</a></button>
<button class="btn btn-light btn-lg" type=button aria-expanded=false><a class=nav-item style=text-decoration:none;text-transform:uppercase href=https://linuxptp.nwtime.org/install/>Install</a></button>
<button class="btn btn-light btn-lg" type=button aria-expanded=false><a class=nav-item style=text-decoration:none;text-transform:uppercase href=https://linuxptp.nwtime.org/getting-involved/>Getting Involved</a></button>
<button class="btn btn-light btn-lg" type=button aria-expanded=false><a class=nav-item style=text-decoration:none;text-transform:uppercase href=https://linuxptp.nwtime.org/documentation/>Documentation</a></button></div><script async src="https://cse.google.com/cse.js?cx=7474c4c5ca53f79ef"></script><div class=gcse-search></ul></div></nav><div class=header-border></div><section class="section pt-0 pb-auto"><div class=container><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=https://linuxptp.nwtime.org/documentation/>Documentation</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://linuxptp.nwtime.org/documentation/ts2phc/>ts2phc(8): Synchronizes one or more PTP Hardware Clocks using external time stamps</a></li></ol></nav><h3 id=ts2phc8-synchronizes-one-or-more-ptp-hardware-clocks-using-external-time-stamps>ts2phc(8): Synchronizes one or more PTP Hardware Clocks using external time stamps</h3><h4 id=synopsis>SYNOPSIS</h4><p><code>ts2phc [ -hmqv ] [ -c <em>device|name</em> ] [ -f <em>config</em> ] [ -l <em>print-level</em> ] [ -s <em>device|name</em> ] [ <em>long-options</em> ] &mldr;</code></p><h4 id=description>DESCRIPTION</h4><p><code>ts2phc</code> synchronizes PTP Hardware Clocks (PHC) to external time stamp signals. A single source may be used to distribute time to one or more PHC devices.</p><h4 id=options>OPTIONS</h4><dl><dt><code><strong>-c <em>device|name</em>)</strong></code></dt><dd><p>Specifies a PHC to be synchronized. The clock may be identified by its character device (like <code>/dev/ptp0</code>) or its associated network interface (like <code>eth0</code>). This option may be given multiple times.</p></dd><dt><code><strong>-f <em>config</em></strong></code></dt><dd><p>Read configuration from the specified file. No configuration file is read by default.</p></dd><dt><code><strong>-h</strong></code></dt><dd><p>Displays the command line help summary.</p></dd><dt><code><strong>-l <em>print-level</em></strong></code></dt><dd><p>Sets the maximum <code>syslog</code> level of messages which should be printed or sent to the system logger. The default is 6 (<code>LOG_INFO</code>).</p></dd><dt><code><strong>-m</strong></code></dt><dd><p>Prints log messages to the standard output.</p></dd><dt><code><strong>-q</strong></code></dt><dd><p>Prevents sending log messages to the system logger.</p></dd><dt><code><strong>-s <em>device|name</em></strong></code></dt><dd><p>Specifies the source of the PPS signal. Use the key word <code>generic</code> for an external 1-PPS without ToD information. When using a PHC as the time source, the clock may be identified by its character device (like <code>/dev/ptp0</code>) or its associated network interface (like <code>eth0</code>). Use the key word <code>nmea</code> for an external 1-PPS from a GPS providing ToD information via the RMC NMEA sentence.</p></dd><dt><code><strong>-v</strong></code></dt><dd><p>Prints the software version and exits.</p></dd></dl><h4 id=long-options>LONG OPTIONS</h4><p>Each and every configuration file option (see below) may also appear as a &ldquo;long&rdquo; style command line argument. For example, the <code>use_syslog</code> option may be set using either of these two forms.</p><p><code>--use_syslog 1</code></p><p><code>--use_syslog=1</code></p><p>Option values given on the command line override values in the global section of the configuration file.</p><h4 id=configuration-file>CONFIGURATION FILE</h4><p>The configuration file is divided into sections. Each section starts with a line containing its name enclosed in brackets and it follows with settings. Each setting is placed on a separate line, it contains the name of the option and the value separated by whitespace characters. Empty lines and lines starting with <code>#</code> are ignored.</p><p>There are two different section types.</p><ol><li><p>The global section (indicated as <code>[global]</code>) sets the program options and the default time sink options. Other sections are clock specific sections, and they override the default options.</p></li><li><p>Time sink sections give the name of the configured PHC (e.g. <code>[eth0]</code>). Time sinks specified in the configuration file need not be specified with the <code>-c</code> command line option.</p></li></ol><h4 id=global-options>GLOBAL OPTIONS</h4><dl><dt><code><strong>first_step_threshold</strong></code></dt><dd><p>The maximum offset, specified in seconds, that the servo will correct by changing the clock frequency instead of stepping the clock. This is only applied on the first update. When set to 0.0, the servo will not step the clock on start. The default is 0.00002 (20 microseconds).</p></dd><dt><code><strong>free_running</strong></code></dt><dd><p>When set to 1, no PHC will be adjusted. This option can be useful in test scenarios, for example to determine how well synchronized a group of local clocks are to each other. The default is 0 (adjust the clocks).</p></dd><dt><code><strong>leapfile</strong></code></dt><dd><p>The path to the current leap seconds definition file. In a Debian system this file is provided by the <code>tzdata</code> package and can be found at <code>/usr/share/zoneinfo/leap-seconds.list</code>. If a leapfile is configured it will be reloaded if modified. The default is an empty string, which causes the program to use a hard coded table that reflects the known leap seconds on the date of the software&rsquo;s release.</p></dd><dt><code><strong>logging_level</strong></code></dt><dd><p>The maximum logging level of messages which should be printed. The default is 6 (<code>LOG_INFO</code>).</p></dd><dt><code><strong>max_frequency</strong></code></dt><dd><p>The maximum allowed frequency adjustment of the clock in parts per billion. This is an additional limit to the maximum allowed by the hardware. When set to 0, the hardware limit will be used. The default is 900000000 (90%).</p></dd><dt><code><strong>message_tag</strong></code></dt><dd><p>The tag which is added to all messages printed to the standard output or system log. The default is an empty string (which cannot be set in the configuration file as the option requires an argument).</p></dd><dt><code><strong>step_threshold</strong></code></dt><dd><p>The maximum offset, specified in seconds, that the servo will correct by changing the clock frequency instead of stepping the clock. When set to 0.0, the servo will never step the clock except on start. The default is 0.0.</p></dd><dt><code><strong>ts2phc.nmea_remote_host, ts2phc.nmea_remote_port</strong></code></dt><dd><p>Specifies the remote host providing ToD information when using the <code>nmea</code> PPS signal source. Note that if these two options are both specified, then the given remote connection will be used in preference to the configured serial port. These options default to the empty string, that is, not specified.</p></dd><dt><code><strong>ts2phc.nmea_serialport, ts2phc.nmea_baudrate</strong></code></dt><dd><p>Specifies the serial port and baudrate in bps for character device providing ToD information when using the <code>nmea</code> PPS signal source. Note that if the options, <code>ts2phc.nmea_remote_host</code> and <code>ts2phc.nmea_remote_port</code>, are both specified, then the given remote connection will be used in preference to the configured serial port. The default serial port is <code>/dev/ttyS0</code>. The default baudrate is 9600 bps.</p></dd><dt><code><strong>ts2phc.pulsewidth</strong></code></dt><dd><p>The expected pulse width of the external PPS signal in nanoseconds. When <code>ts2phc.extts_polarity</code> is <code>both</code>, the given pulse width is used to detect and discard the time stamp of the unwanted edge. The supported range is 1000000 to 990000000 nanoseconds. The default is 500000000 nanoseconds.</p></dd><dt><code><strong>use_syslog</strong></code></dt><dd><p>Print messages to the system log if enabled. The default is 1 (enabled).</p></dd><dt><code><strong>verbose</strong></code></dt><dd><p>Print messages to the standard output if enabled. The default is 0 (disabled).</p></dd></dl><h4 id=time-sink-options>TIME SINK OPTIONS</h4><dl><dt><code><strong>ts2phc.channel</strong></code></dt><dd><p>The external time stamping or periodic output channel to be used. Some PHC devices feature programmable pins and one or more time stamping channels. This option allows selecting a particular channel to be used. When using a PHC device as the PPS source, this option selects the periodic output channel. The default is channel 0.</p></dd><dt><code><strong>ts2phc.extts_correction</strong></code></dt><dd><p>The value, in nanoseconds, to be added to each PPS time stamp. The default is 0 (no correction).</p></dd></dl><p><code><strong>ts2phc.extts_polarity</strong></code></p><p>The polarity of the external PPS signal, either <code>rising</code> or <code>falling</code>. Some PHC devices always time stamp both edges. Setting this option to <code>both</code> will allow the <code>ts2phc</code> program to work with such devices by detecting and ignoring the unwanted edge. In this case be sure to set <code>ts2phc.pulsewidth</code> to the correct value. The default is <code>rising</code>.</p><dl><dt><code><strong>ts2phc.master</strong></code></dt><dd><p>Setting this option to 1 configures the given PHC device as the source of the PPS signal. The default is 0 for the time sink role.</p></dd><dt><code><strong>ts2phc.pin_index</strong></code></dt><dd><p>The pin index to be used. Some PHC devices feature programmable pins, and this option allows configuration of a particular pin for the external time stamping or periodic output function. The default is pin index 0.</p></dd></dl><h4 id=warning>WARNING</h4><p>Be cautious when sharing the same configuration file between <code>ptp4l</code>, <code>phc2sys</code>, and <code>ts2phc</code>. Keep in mind that values specified in the configuration file take precedence over the default values. If an option which is common to the other programs is set in the configuration file, then the value will be applied to all the programs using the file, and this might not be what is expected.</p><p>It is recommended to use separate configuration files for <code>ptp4l</code>, <code>phc2sys</code>, and <code>ts2phc</code> in order to avoid any unexpected behavior.</p><h4 id=see-also>SEE ALSO</h4><p><a href=/documentation/phc2sys/>phc2sys(8)</a>, <a href=/documentation/ptp4l/>ptp4l(8)</a></p></div></section><nav class="site-footer navbar navbar-expand-sm mt-auto"><div class=container><ul class=navbar-nav><li class=nav-item title="Mailing lists" aria-label="Mailing lists"><a class=nav-link target=_blank rel="noopener noreferrer" href=https://sourceforge.net/projects/linuxptp/lists/linuxptp-users><img src=/images/icons/envelope.svg width=20 height=20></img></a></li><li class=nav-item title=LinkedIn aria-label=LinkedIn><a class=nav-link target=_blank rel="noopener noreferrer" href=https://www.linkedin.com/groups/4683708/><img src=/images/icons/linkedin.svg width=20 height=20></img></a></li></ul><ul class="mx-auto pt-3"><p>&copy; 2023 <a class="navbar-text text-white" href=https://www.nwtime.org>Network Time Foundation</a></p></ul></div></nav></body></html>